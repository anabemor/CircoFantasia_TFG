<div class="p-4">
  <h1 class="text-2xl font-semibold mb-4">Gesti√≥n de Usuarios</h1>

  <button (click)="crearUsuario()" class="bg-green-600 text-white px-4 py-2 rounded mb-4">
    Crear Usuario
  </button>

  <table class="w-full border border-gray-300">
    <thead class="bg-gray-200">
      <tr>
        <th class="p-2 text-left">Nombre</th>
        <th class="p-2 text-left">Email</th>
        <th class="p-2 text-left">Rol</th>
        <th class="p-2 text-left">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let usuario of usuarios" class="border-t">
        <td class="p-2">{{ usuario.name }}</td>
        <td class="p-2">{{ usuario.email }}</td>
        <td class="p-2">
          {{ usuario.roles.includes('ROLE_ADMIN') ? 'Administrador' : 'Gestor' }}
        </td>
        <td class="p-2">
          <button (click)="editarUsuario(usuario)" class="text-blue-600 hover:underline mr-2">Editar</button>
          <button (click)="eliminarUsuario(usuario.id!)" class="text-red-600 hover:underline">Eliminar</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Modal -->
<div *ngIf="mostrarModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white p-6 rounded-lg w-[90%] max-w-md shadow-lg">
    <h2 class="text-xl font-semibold mb-4">
      {{ usuarioSeleccionado?.id ? 'Editar Usuario' : 'Crear Usuario' }}
    </h2>

    <form (ngSubmit)="guardarUsuario()" *ngIf="usuarioSeleccionado">
      <label class="block mb-2">
        Nombre:
        <input [(ngModel)]="usuarioSeleccionado.name" name="name" class="border p-2 w-full" required />
      </label>

      <label class="block mb-2">
        Email:
        <input [(ngModel)]="usuarioSeleccionado.email" name="email" class="border p-2 w-full" required type="email" />
      </label>

      <label class="block mb-2">
        Rol:
        <select [(ngModel)]="usuarioSeleccionado.roles" name="roles" class="border p-2 w-full" required>
          <option [ngValue]="['ROLE_ADMIN']">Administrador</option>
          <option [ngValue]="['ROLE_USER']">Gestor</option>
        </select>
      </label>

      <div class="flex justify-end gap-2 mt-4">
        <button type="button" (click)="cerrarModal()" class="bg-gray-300 px-4 py-2 rounded">Cancelar</button>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">
          {{ usuarioSeleccionado.id ? 'Actualizar' : 'Crear' }}
        </button>
      </div>
    </form>
  </div>
</div>
